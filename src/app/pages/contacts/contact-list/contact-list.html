<!-- contact-list.html -->

<main class="contact-list">
  @if (isContactModalOpen) {
    <app-contact-add-form (added)="onAdded()" (closed)="closeModal()"></app-contact-add-form>
  }

  <header class="sticky-top d-none d-lg-block">
    <ui-button variant="primary" (click)="openModal()">
      Add new contact
      <img src="assets/icons/person-add-white-32px.svg" alt="" aria-hidden="true" />
    </ui-button>

    <app-input-field type="text" label="Search" placeholder="Search contacts" icon="assets/icons/search-32px.svg"
      [error]="searchError"
      (inputChange)="onSearchInput($event)"
    />


  </header>

  @for (group of groups; track group.letter) {
    <section class="contacts">
      <header>
        <abbr class="letter">{{ group.letter }}</abbr>
      </header>

      <hr />

      <ul>
        @for (c of group.contacts; track c.id) {
          <li
            class="contacts__item"
            (click)="select.emit(c)"
            [class.Active]="selectedId === c.id"
          >
            <abbr
              class="initialism d-flex d-inline-flex align-items-center justify-content-center rounded-circle"
              [title]="c.name"
              [style.background]="c.color"
            >
              {{ c.initials }}
            </abbr>
            <dl>
              <dt class="contacts__name">{{ c.name }}</dt>
              <dd class="contacts__email fs-6">{{ c.email }}</dd>
            </dl>
          </li>
        }
      </ul>
    </section>
  }

  <!-- Mobile: FAB buttons (hidden on lg+) -->
  <aside class="fab-container d-lg-none" aria-label="Quick actions">
    <button class="fab fab--search" (click)="isMobileSearchOpen = !isMobileSearchOpen" aria-label="Toggle search">
      <img src="assets/icons/search-32px.svg" alt="" aria-hidden="true" />
    </button>
    <button class="fab fab--add" (click)="openModal()" aria-label="Add new contact">
      <img src="assets/icons/person-add-white-32px.svg" alt="" aria-hidden="true" />
    </button>
  </aside>

  <!-- Mobile: search input (toggled by search FAB, hidden on lg+) -->
  @if (isMobileSearchOpen) {
    <search class="mobile-search d-lg-none">
      <app-input-field type="text" label="Search" placeholder="Search contacts" icon="assets/icons/search-32px.svg"
        [error]="searchError"
        (inputChange)="onSearchInput($event)"
      />
    </search>
  }
</main>
